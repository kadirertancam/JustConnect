module.exports = {\n  apps: [\n    {\n      name: 'justconnect-v2',\n      script: './server/server.js',\n      cwd: './',\n      instances: 'max', // Use all CPU cores\n      exec_mode: 'cluster',\n      autorestart: true,\n      watch: false,\n      max_memory_restart: '1G',\n      env: {\n        NODE_ENV: 'production',\n        PORT: 3000\n      },\n      env_development: {\n        NODE_ENV: 'development',\n        PORT: 3000,\n        DEBUG: 'justconnect:*'\n      },\n      env_staging: {\n        NODE_ENV: 'staging',\n        PORT: 3000\n      },\n      \n      // Logging\n      log_file: './logs/pm2-combined.log',\n      out_file: './logs/pm2-out.log',\n      error_file: './logs/pm2-error.log',\n      log_date_format: 'YYYY-MM-DD HH:mm:ss Z',\n      \n      // Advanced PM2 features\n      merge_logs: true,\n      time: true,\n      \n      // Graceful shutdown\n      kill_timeout: 5000,\n      listen_timeout: 10000,\n      \n      // Health monitoring\n      min_uptime: '10s',\n      max_restarts: 10,\n      \n      // Source map support\n      source_map_support: false,\n      \n      // Instance variables\n      instance_var: 'INSTANCE_ID',\n      \n      // Advanced options\n      node_args: '--max-old-space-size=1024',\n      \n      // Cron restart\n      cron_restart: '0 3 * * *', // Restart at 3 AM every day\n      \n      // Ignore watch\n      ignore_watch: [\n        'node_modules',\n        'logs',\n        'uploads',\n        'temp',\n        '.git'\n      ],\n      \n      // Environment variables\n      env_file: '.env'\n    }\n  ],\n  \n  // Deployment configuration\n  deploy: {\n    production: {\n      user: 'deploy',\n      host: ['your-server.com'],\n      ref: 'origin/main',\n      repo: 'https://github.com/kadirertan/justconnect-v2.git',\n      path: '/var/www/justconnect-v2',\n      'pre-deploy-local': '',\n      'post-deploy': 'npm install --production && pm2 reload ecosystem.config.js --env production',\n      'pre-setup': 'apt-get update && apt-get install -y git nodejs npm nginx mongodb-server redis-server'\n    },\n    \n    staging: {\n      user: 'deploy',\n      host: ['staging-server.com'],\n      ref: 'origin/develop',\n      repo: 'https://github.com/kadirertan/justconnect-v2.git',\n      path: '/var/www/justconnect-v2-staging',\n      'post-deploy': 'npm install && pm2 reload ecosystem.config.js --env staging'\n    }\n  }\n};